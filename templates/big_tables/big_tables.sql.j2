{% import 'sql/big_tables.sql' as largest_tables_sql with context %}

select json_agg(table_name || ' (' || pg_size_pretty(total_size) || ')')::text as labels
     , json_agg(total_size)::text as data
     , json_agg((select hex4
                   from ({% include "sql/colors.sql" without context %}) as clrs
                  where clrs.id = rank))::text as colors
  from ({{ largest_tables_sql|string|indent(8, false) }}) s
