{% import 'sql/max_rows_tables.sql' as max_rows_tables_sql with context %}

select json_agg(table_name)::text as labels
     , json_agg(ceil(rows_count/1000))::text as data
     , json_agg(concat('#',lpad(to_hex(round(random() * 10000000)::int4),6,'0')))::text as colors
     {# , json_agg(id) as colors #}
  from ({{ max_rows_tables_sql|string|indent(8, false) }}) s
